(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{144:function(t,e,a){"use strict";a.r(e);a(35),a(146),a(161);var n=a(36),o=a.n(n),i=a(7),r=a.n(i),s=a(0),l=a.n(s),c=a(148),u=a(147),m=a(163),h=a.n(m);a(164);h.a.initializeApp({apiKey:"AIzaSyAm31tTHPuaSkBR1Ff7pYAavUX6K1DlZ5g",authDomain:"let-it-go-ce90f.firebaseapp.com",databaseURL:"https://let-it-go-ce90f.firebaseio.com",projectId:"let-it-go-ce90f",storageBucket:"let-it-go-ce90f.appspot.com",messagingSenderId:"243397254091",appId:"1:243397254091:web:bede1631a9ce7f43"});var d=h.a.firestore();function p(t,e,a,n){if(null===t||null===a||null===e||null===n)return"Location not available";var o=(a-t)*(Math.PI/180),i=(n-e)*(Math.PI/180),r=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*(Math.PI/180))*Math.cos(a*(Math.PI/180))*Math.sin(i/2)*Math.sin(i/2),s=6371e3*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return Math.round(s)}a.d(e,"default",function(){return g}),a.d(e,"query",function(){return y});var f=!0,g=function(t){function e(e){var a;return(a=t.call(this,e)||this).state={toilets:a.props.data.allToilets.nodes.slice(0),myLat:null,myLon:null,sortBy:"name"},a.sortByDistance=a.sortByDistance.bind(o()(a)),a.compareDistance=a.compareDistance.bind(o()(a)),a.sortByName=a.sortByName.bind(o()(a)),a.updatePosition=a.updatePosition.bind(o()(a)),a.handleChange=a.handleChange.bind(o()(a)),a}r()(e,t);var a=e.prototype;return a.componentDidMount=function(){this.updatePosition()},a.handleChange=function(t){this.setState({sortBy:t.target.value}),"name"===t.target.value?this.sortByName():this.sortByDistance()},a.sortByDistance=function(){var t=this.state.toilets.slice(0);t.sort(this.compareDistance),this.setState({toilets:t})},a.compareDistance=function(t,e){return p(t.lat,t.lon,this.state.myLat,this.state.myLon)-p(e.lat,e.lon,this.state.myLat,this.state.myLon)},a.sortByName=function(){console.log("test");var t=this.state.toilets.slice(0);t.sort(function(t,e){return t.name.localeCompare(e.name)}),this.setState({toilets:t})},a.updatePosition=function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){t.setState({myLat:e.coords.latitude,myLon:e.coords.longitude})},function(){f=!1,t.forceUpdate()},{enableHighAccuracy:!0}):(f=!1,this.forceUpdate())},a.render=function(){var t=this;return d.collection("toilets").get().then(function(t){t.forEach(function(t){console.log(t.id,"=>",t.data())})}).catch(function(t){console.log("Error getting documents",t)}),console.log(this.state),l.a.createElement(c.a,{main:!0},l.a.createElement("label",null,"Sort by: "),l.a.createElement("select",{value:this.state.sortBy,onChange:this.handleChange},l.a.createElement("option",{value:"name"},"Name"),f&&l.a.createElement("option",{value:"distance"},"Distance")),!f&&l.a.createElement("p",null,"Location services not working! (Add help popup, convert to component)"),l.a.createElement("table",{style:{tableLayout:"fixed"}},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Name"),l.a.createElement("th",null,"Distance (m)"))),l.a.createElement("tbody",null,this.state.toilets.map(function(e,a){return l.a.createElement("tr",{key:a},l.a.createElement("td",null,l.a.createElement(u.a,{to:"/"+e.name.replace(/\s/g,"")},e.name)),l.a.createElement("td",null,p(t.state.myLat,t.state.myLon,e.lat,e.lon)))}))))},e}(l.a.Component),y="2233172093"},145:function(t,e,a){var n;t.exports=(n=a(149))&&n.default||n},147:function(t,e,a){"use strict";var n=a(0),o=a.n(n),i=a(4),r=a.n(i),s=a(33),l=a.n(s);a.d(e,"a",function(){return l.a});a(145),o.a.createContext({});r.a.object,r.a.string.isRequired,r.a.func,r.a.func},148:function(t,e,a){"use strict";var n=a(0),o=a.n(n),i=a(147);e.a=function(t){return o.a.createElement("div",{style:{margin:"3rem auto",maxWidth:650,padding:"0 1rem"}},!t.main&&o.a.createElement(i.a,{to:"/"},"Back"),t.main&&o.a.createElement("h1",null,"Let It Go"),t.children)}},149:function(t,e,a){"use strict";a.r(e);a(34);var n=a(0),o=a.n(n),i=a(4),r=a.n(i),s=a(56),l=a(2),c=function(t){var e=t.location,a=l.default.getResourcesForPathnameSync(e.pathname);return a?o.a.createElement(s.a,Object.assign({location:e,pageResources:a},a.json)):null};c.propTypes={location:r.a.shape({pathname:r.a.string.isRequired}).isRequired},e.default=c}}]);
//# sourceMappingURL=component---src-pages-index-js-b2b4655b03e6eba89899.js.map