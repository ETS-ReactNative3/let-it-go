(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{142:function(t,e,n){"use strict";n.r(e),n.d(e,"default",function(){return d}),n.d(e,"query",function(){return f});n(35),n(146),n(157);var a=n(36),o=n.n(a),i=n(7),r=n.n(i),s=n(0),c=n.n(s),l=n(148),u=n(147);function m(t,e,n,a){if(null===t||null===n||null===e||null===a)return"Location not available";var o=(n-t)*(Math.PI/180),i=(a-e)*(Math.PI/180),r=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*(Math.PI/180))*Math.cos(n*(Math.PI/180))*Math.sin(i/2)*Math.sin(i/2),s=6371e3*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)));return Math.round(s)}var h=!0,d=function(t){function e(e){var n;return(n=t.call(this,e)||this).state={toilets:n.props.data.allToilets.nodes.slice(0),myLat:null,myLon:null,sortBy:"name"},n.sortByDistance=n.sortByDistance.bind(o()(n)),n.compareDistance=n.compareDistance.bind(o()(n)),n.sortByName=n.sortByName.bind(o()(n)),n.updatePosition=n.updatePosition.bind(o()(n)),n.handleChange=n.handleChange.bind(o()(n)),n}r()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.updatePosition()},n.handleChange=function(t){this.setState({sortBy:t.target.value}),"name"===t.target.value?this.sortByName():this.sortByDistance()},n.sortByDistance=function(){var t=this.state.toilets.slice(0);t.sort(this.compareDistance),this.setState({toilets:t})},n.compareDistance=function(t,e){return m(t.lat,t.lon,this.state.myLat,this.state.myLon)-m(e.lat,e.lon,this.state.myLat,this.state.myLon)},n.sortByName=function(){var t=this.state.toilets.slice(0);t.sort(function(t,e){return t.name.localeCompare(e.name)}),this.setState({toilets:t})},n.updatePosition=function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){t.setState({myLat:e.coords.latitude,myLon:e.coords.longitude})},function(){h=!1,t.forceUpdate()},{enableHighAccuracy:!0}):(h=!1,this.forceUpdate())},n.render=function(){var t=this;return c.a.createElement(l.a,{main:!0},c.a.createElement("label",null,"Sort by: "),c.a.createElement("select",{value:this.state.sortBy,onChange:this.handleChange},c.a.createElement("option",{value:"name"},"Name"),h&&c.a.createElement("option",{value:"distance"},"Distance")),!h&&c.a.createElement("p",null,"Location services not working! (Add help popup, convert to component)"),c.a.createElement("table",{style:{tableLayout:"fixed"}},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Name"),c.a.createElement("th",null,"Distance (m)"))),c.a.createElement("tbody",null,this.state.toilets.map(function(e,n){return c.a.createElement("tr",{key:n},c.a.createElement("td",null,c.a.createElement(u.a,{to:"/"+e.name.replace(/\s/g,"")},e.name)),c.a.createElement("td",null,m(t.state.myLat,t.state.myLon,e.lat,e.lon)))}))))},e}(c.a.Component),f="3825457449"},145:function(t,e,n){var a;t.exports=(a=n(149))&&a.default||a},146:function(t,e,n){var a=n(25).f,o=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in o||n(14)&&a(o,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(t){return""}}})},147:function(t,e,n){"use strict";var a=n(0),o=n.n(a),i=n(4),r=n.n(i),s=n(33),c=n.n(s);n.d(e,"a",function(){return c.a});n(145),o.a.createContext({});r.a.object,r.a.string.isRequired,r.a.func,r.a.func},148:function(t,e,n){"use strict";var a=n(0),o=n.n(a),i=n(147);e.a=function(t){return o.a.createElement("div",{style:{margin:"3rem auto",maxWidth:650,padding:"0 1rem"}},!t.main&&o.a.createElement(i.a,{to:"/"},"Back"),t.main&&o.a.createElement("h1",null,"Let It Go"),t.children)}},149:function(t,e,n){"use strict";n.r(e);n(34);var a=n(0),o=n.n(a),i=n(4),r=n.n(i),s=n(56),c=n(2),l=function(t){var e=t.location,n=c.default.getResourcesForPathnameSync(e.pathname);return n?o.a.createElement(s.a,Object.assign({location:e,pageResources:n},n.json)):null};l.propTypes={location:r.a.shape({pathname:r.a.string.isRequired}).isRequired},e.default=l},157:function(t,e,n){"use strict";var a=n(11),o=n(26),i=n(27),r=n(19),s=[].sort,c=[1,2,3];a(a.P+a.F*(r(function(){c.sort(void 0)})||!r(function(){c.sort(null)})||!n(158)(s)),"Array",{sort:function(t){return void 0===t?s.call(i(this)):s.call(i(this),o(t))}})},158:function(t,e,n){"use strict";var a=n(19);t.exports=function(t,e){return!!t&&a(function(){e?t.call(null,function(){},1):t.call(null)})}}}]);
//# sourceMappingURL=component---src-pages-index-js-9da6e60c6aa04d92dd8d.js.map